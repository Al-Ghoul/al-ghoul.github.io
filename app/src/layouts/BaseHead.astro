---
import "../styles/global.css";

interface Props {
  locale: string;
  title: string;
}

const { locale, title } = Astro.props;
---
<head>
  <meta charset="utf-8" />
  <link rel="icon" type="image/png" href="/favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="generator" content={Astro.generator} />
  <meta name="referrer" content="origin-when-cross-origin" />
  <meta name="twitter:creator" content="@abdo_alghoul" />
  <meta name="twitter:site" content="@abdo_alghoul" />
  <meta name="twitter:site:id" content="960225296258564096" />
  <meta name="twitter:creator:id" content="960225296258564096" />
  <meta name="pinterest-rich-pin" content="true" />
  <link rel="sitemap" href="/sitemap-index.xml" />
  {locale == "ar" ? 
  <link rel="alternate" type="application/rss+xml" title="مدونة عبد الرحمن الغول" href="//al-ghoul.github.io/feed.xml" />
  :
  <link rel="alternate" type="application/rss+xml" title="Abdulrahman AlGhoul's Blog" href="https://al-ghoul.github.io/en/feed.xml" />}
  <meta name="google-site-verification" content="PctrSuhGX5V25m3PvBGETkXtehoL6prlMAsSPWdc8es" />
  <slot />
  <title>{title}</title>

  <script is:inline>
  (function() {
    const hash = window.location.hash.slice(1);
    if (!hash) return;

    const decodedHash = decodeURIComponent(hash);

    let scrolled = false;

    function attemptScroll() {
      if (scrolled) return false;

      const element = document.getElementById(decodedHash);
      if (element) {
        scrolled = true;
        requestAnimationFrame(() => {
          setTimeout(() => {
            const yOffset = -180;
            const y = element.getBoundingClientRect().top + window.pageYOffset + yOffset;
            window.scrollTo({ top: y, behavior: "smooth" });
          }, 200);
        });
        return true;
      }
      return false;
    }

    if ('scrollRestoration' in history) {
      history.scrollRestoration = 'manual';
    }
    window.scrollTo(0, 0);

    const observer = new MutationObserver(attemptScroll);
    observer.observe(document.documentElement, {
      childList: true,
      subtree: true
    });

    const checks = [100, 300, 500, 800, 1200, 2000];
    checks.forEach(delay => {
      setTimeout(() => {
        if (attemptScroll()) {
          observer.disconnect();
        }
      }, delay);
    });

    setTimeout(() => observer.disconnect(), 10000);
  })();
  </script>
</head>
